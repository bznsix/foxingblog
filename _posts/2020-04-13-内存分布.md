## 概述

内存空间的分布：

![内存空间1](C:\Users\Administrator\Desktop\我的博客\pictures\C语言学习\内存空间1.png)

注意：const修饰的变量仍然可以通过指针进行修改。

但是你定义的字符串是存在于只读数据段的，不可通过指针的方式进行修改，编译器将会报段错误。例如：

```c
char *p1 = "hello world";//这里的字符串是存放于只读区
p1[3] = '1';//对只读的修改将会导致段错误
```

## 数据段

对变量加static进行修饰，变量将会存放于全局的数据空间。但是他只能被局部的函数进行访问。

```c
#include <stido.h>
int b = 100;

int fun()
{
    static int a = 100;
    return a++;;    
}

int main()
{
    static int a;
    a = 0x10;
    printf("the a is %p\n",&a);
    printf("the is %p\n",main);
    
    return 0;
}
```

利用nm 可以列出全局数据段中的变量

![内存空间2](C:\Users\Administrator\Desktop\我的博客\pictures\C语言学习\内存空间2.png)

可以发现有两个a,用来区别是fun(),还是main()中的

## 内存中的堆空间

区别：

*只读空间*：静态空间，整个程序结束时释放内存，生存周期最长。

*栈空间*：运行时，函数内部使用的变量，函数一旦返回就释放，生存周期是函数内。

*堆空间*：运行时自由分配和释放，程序员决定。

![内存空间3](C:\Users\Administrator\Desktop\我的博客\pictures\C语言学习\内存空间3.png)

注意：使用完后一定要用free(p)来进行释放，否则会造成典型的内存泄漏事故。

申请地址时也要注意变量的大小 `int a[5];` 申请大小应为 `malloc(5*sizeof(int));`